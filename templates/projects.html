{% extends "base.html" %}
{% load staticfiles thumbnail i18n %}

{% block scripts %}
    {{block.super}}
    <script src="https://api-maps.yandex.ru/2.1/?apikey=a2718abd-328d-4bd5-a0e1-f246345a30d4&lang=ru_RU" type="text/javascript"></script>
    <script type="text/javascript">
        // Функция ymaps.ready() будет вызвана, когда
        // загрузятся все компоненты API, а также когда будет готово DOM-дерево.
        var _coords = [[[[58.252231, 29.618951], [58.258698, 29.822978], [58.272543, 29.814584], [58.273386, 29.836738], [58.28076, 29.830675], [58.288569, 29.86347], [58.302425, 29.851336], [58.30174, 29.902136], [58.309482, 29.893696], [58.30978, 29.914508], [58.349622, 29.914627], [58.360143, 29.93627], [58.363111, 29.905906], [58.377507, 29.895479], [58.388205, 29.918502], [58.380033, 29.946765], [58.392387, 29.955474], [58.38782, 29.976606], [58.395498, 29.986965], [58.409361, 29.975522], [58.406534, 29.963863], [58.418994, 29.942817], [58.411752, 29.907837], [58.399313, 29.924443], [58.389834, 29.915106], [58.400678, 29.890611], [58.413058, 29.891777], [58.422084, 29.877164], [58.437922, 29.919437], [58.447096, 29.912359], [58.431898, 29.894384], [58.44074, 29.878731], [58.453325, 29.900886], [58.442668, 29.930883], [58.45883, 29.935281], [58.44887, 29.965921], [58.439513, 29.945182], [58.435959, 29.953272], [58.447457, 30.069546], [58.474466, 30.062322], [58.492069, 30.133492], [58.502442, 30.093133], [58.515323, 30.100199], [58.530224, 30.174649], [58.564444, 30.120719], [58.607806, 30.097671], [58.624804, 30.07331], [58.641429, 30.111954], [58.653904, 30.070423], [58.64924, 30.06002], [58.667512, 30.064757], [58.672381, 30.104583], [58.693708, 30.137453], [58.702203, 30.109729], [58.704721, 30.117899], [58.719972, 30.094302], [58.728079, 30.104552], [58.721042, 30.121903], [58.745379, 30.122056], [58.74658, 30.169962], [58.759989, 30.188087], [58.748318, 30.206001], [58.761215, 30.217005], [58.744428, 30.230263], [58.748712, 30.283393], [58.736751, 30.289789], [58.744137, 30.324173], [58.760569, 30.340775], [58.746439, 30.348457], [58.748361, 30.364391], [58.739591, 30.379494], [58.719471, 30.369381], [58.718796, 30.390142], [58.703142, 30.408158], [58.702084, 30.447439], [58.724008, 30.49798], [58.726843, 30.563009], [58.704617, 30.574497], [58.704858, 30.587363], [58.716006, 30.598744], [58.715355, 30.61984], [58.736967, 30.664736], [58.728731, 30.678377], [58.721699, 30.668733], [58.716815, 30.690375], [58.729868, 30.7162], [58.747458, 30.700848], [58.809124, 30.715187], [58.81434, 30.728173], [58.836546, 30.692978], [58.833888, 30.679103], [58.859251, 30.683177], [58.85388, 30.705729], [58.857344, 30.7369], [58.87072, 30.749916], [58.856656, 30.762523], [58.874355, 30.775171], [58.876579, 30.813316], [58.920815, 30.920843], [58.963213, 30.965398], [58.973662, 30.954655], [58.999766, 31.006332], [59.015741, 30.972284], [59.015701, 30.956722], [59.032555, 30.956762], [59.031844, 30.971863], [59.04405, 30.972705], [59.040688, 30.991329], [59.068166, 31.022334], [59.077155, 31.050125], [59.069281, 31.062706], [59.090873, 31.083082], [59.089932, 31.131482], [59.075808, 31.166841], [59.054957, 31.156768], [59.050267, 31.175681], [59.04683, 31.166752], [59.046943, 31.190707], [59.00645, 31.22362], [59.008011, 31.303827], [59.027677, 31.32013], [59.027136, 31.371497], [59.047315, 31.375589], [59.05374, 31.355532], [59.072386, 31.429154], [59.101998, 31.481214], [59.124548, 31.467773], [59.138825, 31.487301], [59.165677, 31.493073], [59.164763, 31.472536], [59.200522, 31.510977], [59.206622, 31.499736], [59.212204, 31.512263], [59.20243, 31.530432], [59.211446, 31.569178], [59.231112, 31.583061], [59.283542, 31.537867], [59.294215, 31.542749], [59.29812, 31.570909], [59.315361, 31.542529], [59.369014, 31.55272], [59.376513, 31.607773], [59.361522, 31.650271], [59.360924, 31.687542], [59.348087, 31.706682], [59.348211, 31.735901], [59.342474, 31.73221], [59.343875, 31.701284], [59.335429, 31.711566], [59.342716, 31.747402], [59.339369, 31.760848], [59.322581, 31.725536], [59.315232, 31.741305], [59.320733, 31.753351], [59.313418, 31.80211], [59.327526, 31.822719], [59.338515, 31.788124], [59.353771, 31.802777], [59.367066, 31.888023], [59.378259, 31.871657], [59.36958, 31.890001], [59.373262, 31.903875], [59.41436, 31.932288], [59.434407, 31.979188], [59.421804, 31.992406], [59.406585, 31.969857], [59.409476, 32.002175], [59.386896, 32.031747], [59.404772, 32.033632], [59.386025, 32.080097], [59.382117, 32.119639], [59.371787, 32.115126], [59.31885, 32.188478], [59.33937, 32.224763], [59.3554, 32.226776], [59.333355, 32.225546], [59.310841, 32.186292], [59.30399, 32.191941], [59.325794, 32.255191], [59.34366, 32.238521], [59.333347, 32.261319], [59.325926, 32.260663], [59.320712, 32.240895], [59.289637, 32.201108], [59.276121, 32.220007], [59.290417, 32.249932], [59.288763, 32.277217], [59.278437, 32.298435], [59.263259, 32.292993], [59.264337, 32.319728], [59.259028, 32.280206], [59.243403, 32.290898], [59.246807, 32.314241], [59.242446, 32.317063], [59.224233, 32.28705], [59.214917, 32.302291], [59.211475, 32.279748], [59.200783, 32.282434], [59.195903, 32.305139], [59.187822, 32.306579], [59.162859, 32.393458], [59.151569, 32.47654], [59.137224, 32.474728], [59.151219, 32.433201], [59.150543, 32.407454], [59.141765, 32.390044], [59.132414, 32.399944], [59.130117, 32.419087], [59.116046, 32.430236], [59.117529, 32.449034], [59.106944, 32.449019], [59.112339, 32.502026], [59.135804, 32.578171], [59.115683, 32.566734], [59.109758, 32.616426], [59.118429, 32.652364], [59.144303, 32.678567], [59.148484, 32.727409], [59.174269, 32.729301], [59.174999, 32.74711], [59.188222, 32.764693], [59.195378, 32.73856], [59.20613, 32.766064], [59.218224, 32.770684], [59.230773, 32.74609], [59.239756, 32.737241], [59.248027, 32.744968], [59.257755, 32.725635], [59.264594, 32.745312], [59.276043, 32.737042], [59.285959, 32.763504], [59.302352, 32.774485], [59.348628, 32.847595], [59.348334, 32.92184], [59.373309, 32.939325], [59.39204, 32.971768], [59.419041, 32.967143], [59.425076, 32.991424], [59.426235, 33.027442], [59.418356, 33.063811], [59.379913, 33.070086], [59.388367, 33.116107], [59.371323, 33.140805], [59.383712, 33.159491], [59.363197, 33.216852], [59.362456, 33.2369], [59.337256, 33.262193], [59.320546, 33.260443], [59.314684, 33.341035], [59.385398, 33.352597], [59.377763, 33.453883], [59.377899, 33.528687], [59.386888, 33.541947], [59.382089, 33.634926], [59.327463, 33.623179], [59.328729, 33.664962], [59.322015, 33.674098], [59.309683, 33.66389], [59.311492, 33.6919], [59.299104, 33.708046], [59.298192, 33.736585], [59.288058, 33.748132], [59.292152, 33.761211], [59.287307, 33.770115], [59.278476, 33.759123], [59.283474, 33.776839], [59.264174, 33.784171], [59.258328, 33.806116], [59.248666, 33.807232], [59.249078, 33.795588], [59.239403, 33.80367], [59.234558, 33.823273], [59.227671, 33.82381], [59.229163, 33.809824], [59.215816, 33.793508], [59.200193, 33.802932], [59.206637, 33.909267], [59.238474, 33.928024], [59.199313, 33.931933], [59.186971, 33.949214], [59.185363, 33.968433], [59.17275, 33.975708], [59.161605, 34.013716], [59.147978, 34.03198], [59.150789, 34.068037], [59.141132, 34.07677], [59.145926, 34.092846], [59.137851, 34.105185], [59.141901, 34.116845], [59.157968, 34.118466], [59.15918, 34.103543], [59.170301, 34.106282], [59.183342, 34.159934], [59.173229, 34.176837], [59.173316, 34.205278], [59.20599, 34.215563], [59.207784, 34.249051], [59.188824, 34.257244], [59.178414, 34.284894], [59.184042, 34.331369], [59.190836, 34.319723], [59.204247, 34.350551], [59.178486, 34.381051], [59.183338, 34.392389], [59.160786, 34.398496], [59.156855, 34.423849], [59.144063, 34.423058], [59.160286, 34.451051], [59.141558, 34.480262], [59.14581, 34.510262], [59.118705, 34.555888], [59.122056, 34.579856], [59.114164, 34.628188], [59.122054, 34.659069], [59.098431, 34.707788], [59.098254, 34.726119], [59.076456, 34.724012], [59.060168, 34.788733], [59.049827, 34.895617], [59.037498, 34.878408], [59.022936, 34.885205], [59.005614, 34.853], [58.991396, 34.867817], [58.972958, 34.962875], [58.954146, 34.950463], [58.94855, 34.95977], [58.941067, 34.994055], [58.951476, 35.012635], [58.949821, 35.050874], [58.932579, 35.047626], [58.934049, 35.009062], [58.925424, 35.006402], [58.926548, 35.069926], [58.950959, 35.126945], [58.94925, 35.156145], [58.943323, 35.156207], [58.948591, 35.178386], [58.928663, 35.179617], [58.918119, 35.198459], [58.90498, 35.184347], [58.907979, 35.163155], [58.88295, 35.136005], [58.848324, 35.14261], [58.814543, 35.131195], [58.829677, 35.22658], [58.822316, 35.222836], [58.816078, 35.245384], [58.807247, 35.225724], [58.790367, 35.224825], [58.797397, 35.239983], [58.792938, 35.252813], [58.781436, 35.246675], [58.785988, 35.278796], [58.767323, 35.283415], [58.798765, 35.299122], [58.799688, 35.317451], [58.826136, 35.365768], [58.83816, 35.364336], [58.83975, 35.343205], [58.846949, 35.359444], [58.84124, 35.387873], [58.85041, 35.408623], [58.848091, 35.438414], [58.861028, 35.461608], [58.847943, 35.46982], [58.838772, 35.501106], [58.847931, 35.515312], [58.847204, 35.554447], [58.830511, 35.557888], [58.828886, 35.575885], [58.810392, 35.584149], [58.818485, 35.724673], [58.821735, 35.712922], [58.83841, 35.723756], [58.841301, 35.711997], [58.84266, 35.75564], [58.80966, 35.825977], [58.812414, 35.799362], [58.826096, 35.77871], [58.820389, 35.762746], [58.823296, 35.744421], [58.780566, 35.752425], [58.769379, 35.78034], [58.753757, 35.784707], [58.757936, 35.837247], [58.742772, 35.869904], [58.758471, 35.902196], [58.748868, 35.930749], [58.749429, 35.975304], [58.736528, 35.967566], [58.739333, 35.927172], [58.732737, 35.925372], [58.726018, 35.947729], [58.732123, 35.996476], [58.722724, 35.964942], [58.720279, 35.995963], [58.703953, 35.995526], [58.703543, 36.006858], [58.727283, 36.019643], [58.710929, 36.065394], [58.720268, 36.066664], [58.722019, 36.109084], [58.672679, 36.116177], [58.633106, 36.153585], [58.62479, 36.130269], [58.610274, 36.1404], [58.618777, 36.166119], [58.61887, 36.199491], [58.609901, 36.201982], [58.600799, 36.229223], [58.578178, 36.225625], [58.546878, 36.194975], [58.535048, 36.200914], [58.532828, 36.176905], [58.524069, 36.191059], [58.520086, 36.178736], [58.511846, 36.182929], [58.50118, 36.15388], [58.498056, 36.130256], [58.504265, 36.103434], [58.495919, 36.076446], [58.490734, 36.082678], [58.48043, 36.060871], [58.472193, 36.017114], [58.459284, 36.020037], [58.465395, 35.942125], [58.441426, 35.918204], [58.439546, 35.942829], [58.424863, 35.933408], [58.421863, 35.917284], [58.435547, 35.904102], [58.433082, 35.889017], [58.422672, 35.889236], [58.416717, 35.836489], [58.428939, 35.830449], [58.431807, 35.771303], [58.453123, 35.775543], [58.435799, 35.731936], [58.441971, 35.689866], [58.448789, 35.691618], [58.451527, 35.659101], [58.459979, 35.645095], [58.451389, 35.625199], [58.456827, 35.555349], [58.446054, 35.540259], [58.4475, 35.520064], [58.42883, 35.50157], [58.429007, 35.461868], [58.415727, 35.477624], [58.409802, 35.472152], [58.406876, 35.37707], [58.412933, 35.33224], [58.407543, 35.329189], [58.407861, 35.304554], [58.395473, 35.303259], [58.386075, 35.263997], [58.390726, 35.255762], [58.382451, 35.245557], [58.36654, 35.283597], [58.31659, 35.25593], [58.297569, 35.26595], [58.275482, 35.259284], [58.255679, 35.232169], [58.258496, 35.20796], [58.248232, 35.195113], [58.238218, 35.140728], [58.213027, 35.120574], [58.215442, 35.090271], [58.206546, 35.06044], [58.194338, 35.06127], [58.207235, 35.005332], [58.225256, 34.986248], [58.218906, 34.956561], [58.230214, 34.955006], [58.223583, 34.898769], [58.226228, 34.8532], [58.230794, 34.82397], [58.245761, 34.796525], [58.232922, 34.756937], [58.223239, 34.750399], [58.21646, 34.726877], [58.201249, 34.691748], [58.199819, 34.690382], [58.200657, 34.726438], [58.18559, 34.719199], [58.17227, 34.73883], [58.153466, 34.710854], [58.1414, 34.73285], [58.090244, 34.723369], [58.073805, 34.67244], [58.083338, 34.660281], [58.077247, 34.646694], [58.094335, 34.614893], [58.106189, 34.618322], [58.104761, 34.598643], [58.11769, 34.598342], [58.114656, 34.562029], [58.104787, 34.553197], [58.116647, 34.528778], [58.114317, 34.504689], [58.126885, 34.484327], [58.139097, 34.497568], [58.154352, 34.472428], [58.148945, 34.426247], [58.161106, 34.370506], [58.170993, 34.379644], [58.177796, 34.356166], [58.160355, 34.337215], [58.167525, 34.332082], [58.176604, 34.280046], [58.187552, 34.277931], [58.190104, 34.20856], [58.199033, 34.188758], [58.205359, 34.205708], [58.211778, 34.182823], [58.212812, 34.169238], [58.199651, 34.1493], [58.213791, 34.134529], [58.213224, 34.121949], [58.19643, 34.093218], [58.195561, 34.048678], [58.18489, 34.027061], [58.204612, 34.019315], [58.212279, 33.995003], [58.202249, 33.987386], [58.199461, 33.964555], [58.180395, 33.973485], [58.140288, 33.820836], [58.139796, 33.802495], [58.169658, 33.779984], [58.163084, 33.742213], [58.169793, 33.706243], [58.152749, 33.697652], [58.147046, 33.667735], [58.14058, 33.668724], [58.128945, 33.638114], [58.108299, 33.636007], [58.112805, 33.617365], [58.122502, 33.617733], [58.120371, 33.586165], [58.108702, 33.575625], [58.101322, 33.603415], [58.091278, 33.59593], [58.058989, 33.528429], [58.026624, 33.563309], [58.036303, 33.625575], [58.005598, 33.626487], [58.000003, 33.69094], [57.976363, 33.676613], [57.96916, 33.690773], [57.962191, 33.668443], [57.899144, 33.680283], [57.873511, 33.646112], [57.869419, 33.60364], [57.875714, 33.59725], [57.85168, 33.545988], [57.844664, 33.575613], [57.835687, 33.565488], [57.835157, 33.544285], [57.794927, 33.562389], [57.790269, 33.540527], [57.762978, 33.544191], [57.757218, 33.567032], [57.746445, 33.563988], [57.727924, 33.591812], [57.72686, 33.579055], [57.713756, 33.568292], [57.710895, 33.535066], [57.729045, 33.507563], [57.717543, 33.506882], [57.720061, 33.483394], [57.699237, 33.491795], [57.680193, 33.475366], [57.700647, 33.427052], [57.668793, 33.353383], [57.657307, 33.353766], [57.649879, 33.30657], [57.627783, 33.30066], [57.607173, 33.329211], [57.583631, 33.316286], [57.583773, 33.293882], [57.565836, 33.305681], [57.549829, 33.293409], [57.554459, 33.268319], [57.54509, 33.253689], [57.54559, 33.233979], [57.479679, 33.231121], [57.464118, 33.266234], [57.439154, 33.263394], [57.440935, 33.254721], [57.421198, 33.264506], [57.411276, 33.239616], [57.412119, 33.214982], [57.424466, 33.196573], [57.422266, 33.177623], [57.431196, 33.158565], [57.443105, 33.183104], [57.454605, 33.18267], [57.455064, 33.15567], [57.465765, 33.127582], [57.467403, 33.07857], [57.442605, 33.073861], [57.431026, 33.048687], [57.436298, 33.017987], [57.452395, 32.992227], [57.446764, 32.961499], [57.465883, 32.937415], [57.445118, 32.917515], [57.46685, 32.790118], [57.438895, 32.766381], [57.443595, 32.747966], [57.436468, 32.715945], [57.4302, 32.705588], [57.407029, 32.707127], [57.409223, 32.684173], [57.398835, 32.665157], [57.345366, 32.627379], [57.335296, 32.63166], [57.329225, 32.59572], [57.320246, 32.585741], [57.339855, 32.541668], [57.325304, 32.545581], [57.298544, 32.50839], [57.297114, 32.49346], [57.28418, 32.485839], [57.287415, 32.473899], [57.267993, 32.431152], [57.262404, 32.391062], [57.224676, 32.376607], [57.226231, 32.326603], [57.238068, 32.316938], [57.23929, 32.29276], [57.248568, 32.291689], [57.263298, 32.260804], [57.256427, 32.238648], [57.230019, 32.233539], [57.226279, 32.24681], [57.203657, 32.252261], [57.190318, 32.227541], [57.194727, 32.192439], [57.179792, 32.180987], [57.185498, 32.104207], [57.175613, 32.082164], [57.157756, 32.079059], [57.152151, 32.017989], [57.112215, 32.000354], [57.115823, 31.979686], [57.093933, 31.92497], [57.08221, 31.937371], [57.073432, 31.930673], [57.095142, 31.88341], [57.101742, 31.89569], [57.125621, 31.898579], [57.123042, 31.86125], [57.10303, 31.825079], [57.102387, 31.793067], [57.095216, 31.787402], [57.115412, 31.749599], [57.127599, 31.760572], [57.130878, 31.737811], [57.118875, 31.72222], [57.107691, 31.74559], [57.090646, 31.740195], [57.08996, 31.724027], [57.070949, 31.707099], [57.069908, 31.681049], [57.063617, 31.687609], [57.058075, 31.669784], [57.044067, 31.670379], [57.025785, 31.64527], [57.013743, 31.652794], [57.009379, 31.690298], [57.000396, 31.691902], [57.003326, 31.649463], [56.992742, 31.641522], [56.982565, 31.57932], [56.963715, 31.565143], [56.948641, 31.528966], [56.955112, 31.506622], [56.948466, 31.500048], [56.951697, 31.48493], [56.944872, 31.464893], [56.953123, 31.440891], [56.922772, 31.434043], [56.909813, 31.395001], [56.928291, 31.369332], [56.930412, 31.342391], [56.940281, 31.333811], [56.94006, 31.307201], [56.954803, 31.320271], [56.94903, 31.303868], [56.954762, 31.292336], [56.949523, 31.275934], [56.952873, 31.242393], [56.937209, 31.22345], [56.94274, 31.205987], [56.933106, 31.100958], [56.939849, 31.075921], [56.956888, 31.069156], [56.957906, 31.053365], [56.976502, 31.030457], [56.987636, 31.030314], [56.988088, 31.007284], [56.979473, 31.009702], [56.974406, 30.975394], [56.968836, 30.977944], [56.973295, 30.937891], [56.968177, 30.910874], [56.952288, 30.881778], [56.944734, 30.885315], [56.943906, 30.861981], [56.931733, 30.849387], [56.933918, 30.837906], [56.956703, 30.844034], [56.959831, 30.816778], [56.949951, 30.818665], [56.945229, 30.764745], [56.974562, 30.72944], [56.983073, 30.689044], [56.996345, 30.700626], [57.004283, 30.676318], [57.04304, 30.689676], [57.15024, 30.687246], [57.176888, 30.627539], [57.263618, 30.745456], [57.304236, 30.535411], [57.349672, 30.463108], [57.367269, 30.496989], [57.374811, 30.494328], [57.388087, 30.53722], [57.395453, 30.522599], [57.391688, 30.497323], [57.402819, 30.482026], [57.398142, 30.44877], [57.385038, 30.452774], [57.372835, 30.47572], [57.364393, 30.455123], [57.367791, 30.426211], [57.397226, 30.410859], [57.40478, 30.436122], [57.426317, 30.422778], [57.440517, 30.46004], [57.466011, 30.463012], [57.476787, 30.489998], [57.483787, 30.485333], [57.485226, 30.504], [57.495995, 30.505002], [57.494915, 30.522675], [57.501377, 30.529349], [57.508019, 30.531359], [57.502279, 30.513679], [57.506229, 30.479657], [57.522025, 30.463297], [57.528493, 30.496335], [57.544289, 30.504347], [57.546977, 30.542417], [57.555231, 30.546432], [57.55702, 30.5618], [57.643259, 30.683489], [57.642494, 30.519432], [57.669964, 30.492978], [57.687369, 30.456435], [57.721489, 30.496991], [57.726333, 30.472159], [57.73423, 30.47316], [57.745367, 30.502698], [57.775524, 30.496983], [57.775662, 30.434875], [57.783039, 30.418], [57.801548, 30.434081], [57.80084, 30.492946], [57.806765, 30.511106], [57.815022, 30.507406], [57.816099, 30.520525], [57.839792, 30.539724], [57.856489, 30.529973], [57.863845, 30.544464], [57.870673, 30.525267], [57.884139, 30.519208], [57.886648, 30.47404], [57.879465, 30.465285], [57.878728, 30.42451], [57.90383, 30.387697], [57.903423, 30.343523], [57.917593, 30.333676], [57.914127, 30.297937], [57.899359, 30.270376], [57.896251, 30.242414], [57.892131, 30.246826], [57.902826, 30.21269], [57.895819, 30.209041], [57.895594, 30.190838], [57.908427, 30.155313], [57.927309, 30.16829], [57.941163, 30.115836], [57.939447, 30.084127], [57.950597, 30.090748], [57.958795, 30.072754], [57.942459, 29.991507], [57.955436, 29.977503], [57.957295, 29.961321], [57.945707, 29.938887], [57.94135, 29.900013], [57.955327, 29.907264], [57.958994, 29.882991], [57.950247, 29.867702], [57.964228, 29.873929], [57.968935, 29.889198], [57.996172, 29.876298], [57.990359, 29.899219], [57.994766, 29.923273], [58.004065, 29.919794], [58.008077, 29.953319], [58.024796, 29.947775], [58.033246, 29.993225], [58.045277, 29.991022], [58.048208, 29.976846], [58.038834, 29.936779], [58.046018, 29.936524], [58.042556, 29.894171], [58.063046, 29.887623], [58.071024, 29.857551], [58.067497, 29.835502], [58.091666, 29.78895], [58.085085, 29.7567], [58.097326, 29.742197], [58.090383, 29.705548], [58.07766, 29.690906], [58.077724, 29.654558], [58.087032, 29.661127], [58.101251, 29.630332], [58.128664, 29.673865], [58.142137, 29.665442], [58.165453, 29.68117], [58.166853, 29.702924], [58.184852, 29.673452], [58.189135, 29.688092], [58.206374, 29.688179], [58.214335, 29.636856], [58.224028, 29.637572], [58.224017, 29.651521], [58.232084, 29.65768]]]];

        function onSpinner() {
            let spinner = '<div class="on-load-wrap"><div class="on-load"><div class="spinner"></div></div></div>';
            $('.map-wrap').append(spinner);
        }
        function offSpinner() {
            $('.on-load-wrap').remove();
        }

        if (typeof _coords !== "undefined") {
            ymaps.ready(init);
        }

        var windowWidth = $(window).width();

        var mapid = '';

        if (windowWidth > 1023) {
            mapid = "map";
        } else {
            mapid = "mobile_map"
        }

        function init(){

            // Создание карты.
            var __mapCoords = [];
            __mapCoords[0] = 55.753994;
            __mapCoords[1] = 37.622093;
            self.__map = new ymaps.Map(mapid,
                {
                    center: __mapCoords,
                    zoom: 12,
                    controls: ["zoomControl"]
                },
                {
                    searchControlNoPlacemark: true
                }
            ),
                objectManager = new ymaps.ObjectManager(
                    {
                        clusterize: true,
                        gridSize: 32,
                        zIndex: 3
                    }
                );
            myPieChart = [];
            {% for item in projects_to_map %}
                myPieChart[{{forloop.counter}} -1] = new ymaps.Placemark({{item.marker}}, {}, {
                    preset: 'islands#circleIcon',
                    iconColor: '{{item.category.color}}'
                });
                myPieChart[{{forloop.counter}} -1].events.add('click', function (e) {
                    mapprojectFunction({{item.rayon.id}}, {{item.category.id}}, {{item.id}});
                });
                /* self.__map.geoObjects
                     .add(myPieChart);*/
            {% endfor %}

            clusterer = new ymaps.Clusterer({
                // Макет метки кластера pieChart.
                clusterIconLayout: 'default#pieChart',
                // Радиус диаграммы в пикселях.
                clusterIconPieChartRadius: 20,
                // Радиус центральной части макета.
                clusterIconPieChartCoreRadius: 10,
                // Ширина линий-разделителей секторов и внешней обводки диаграммы.
                clusterIconPieChartStrokeWidth: 3,
                // Определяет наличие поля balloon.
                hasBalloon: false,
                maxZoom: 0,
                groupByCoordinates: false,
            });

            /**
             * В кластеризатор можно добавить javascript-массив меток (не геоколлекцию) или одну метку.
             * @see https://api.yandex.ru/maps/doc/jsapi/2.1/ref/reference/Clusterer.xml#add
             */

            clusterer.add(myPieChart);
            self.__map.geoObjects.add(clusterer);
            for (let key in _coords) {
                let bP = _coords[key];
                var polygon = new ymaps.Polygon(
                    bP,
                    {
                        hintContent: ''
                    }, {
                        fillColor: '#51FFB1',
                        interactivityModel: 'default#transparent',
                        strokeWidth: 2,
                        strokeColor: '#51FFB1',
                        strokeOpacity: 1,
                        opacity: 0.3
                    });
            }

            self.__map.geoObjects.add(polygon);
            self.__map.setBounds(__map.geoObjects.getBounds());
        }

        $(document).ready(function() {
            $('.region_btn').unbind("click").click (function () {
                event.preventDefault();


                //history.pushState(null, null, '/rayon/?id='+$(this).attr("data-id"));
                $.ajax({
                    url: "/rayon/",
                    type: "GET",
                    data: {id: $(this).attr("data-id")},
                    cache: false,
                    dataType: "json",
                    beforeSend: function(){
                        onSpinner();
                    },
                    success: function (resp) {
                        var rayon_coords = JSON.parse(resp.coords);
                        var ob_list = resp.ob_list;
                        var r_id = resp.id;
                        if (self.__map.geoObjects) {
                            self.__map.geoObjects.removeAll();
                        }
                        mapInit(r_coords = rayon_coords, objects_list = ob_list, rayon_id = r_id);

                        html = '';

                        if (resp.full_objects_count || resp.full_investments) {
                            html += '<div class="region-info">';
                            if (resp.full_objects_count) {
                                html += '<div><p class="region-info__count">' + resp.full_objects_count + '</p><p class="region-info__subtitle">всего объектов</p></div>';
                            }
                            if (resp.full_investments) {
                                html += '<div><p class="region-info__count">' + resp.full_investments + '</p><p class="region-info__subtitle">объем финансирования</p></div>';
                            }
                            html += '</div>';
                        }

                        html += '<div id="accordion">';
                        for (item in resp.r_c_list) {
                            html +=
                                '<div class="card"><div class="card-header" id="heading-' + item + '"><a class="" data-toggle="collapse" data-target="#collapse-' + item + '" aria-expanded="true" aria-controls="collapseOne"><p class="card-title">'

                                + resp.r_c_list[item].category_name +

                                '</p><p class="card-subtitle">'

                                + resp.r_c_list[item].objects_count + ', ' + resp.r_c_list[item].investments +

                                '</p></a></div>' +
                                '<div id="collapse-' + item + '" class="collapse card-content" aria-labelledby="heading-' + item + '" data-parent="#accordion">';

                            if (resp.r_c_list[item].rayon_sub_category) {
                                var sub_category = resp.r_c_list[item].rayon_sub_category;

                                for (i in sub_category) {
                                    html +=
                                        '<div><p class="card-content__title">'
                                        + sub_category[i].category_name +
                                        '</p><p class="card-content__subtitle">'
                                        + sub_category[i].objects_count + ', ' + sub_category[i].investments +
                                        '</p></div>';
                                }
                            }

                            html += '</div></div>';
                        }
                        html += '</div>';
                        /*
                        if (resp.infografika_im || resp.mobile_infografika_im) {
                            html += '<div uk-lightbox class="d-none d-md-block"><a href="' + resp.infografika_im + '" class="region-pasport-btn mt-1" style="background-color: #F2F2F2; color: #4F4F4F;">Паспорт MO</a></div>';

                            if (resp.mobile_infografika_im) {
                                html += '<div uk-lightbox class="d-md-none d-block"><a href="' + resp.mobile_infografika_im + '" class="region-pasport-btn mt-1" style="background-color: #F2F2F2; color: #4F4F4F;">Паспорт MO</a></div>';
                            }

                        }
                            */
                        for (item in resp.c_list) {

                            html += '<div><a class="category_btn my-1" onclick="getCategory(this)" data-id="' + item + '" data-rayon-id="' + resp.id + '" style="background-color: ' + resp.c_color[item] + '" value="' + item + '"> <img src="' + resp.c_img[item] + '" alt=""><div>' + resp.c_list[item] + ' <span class="font-weight-normal">(' + resp.c_count[item] + ')</span></div></a></div>';

                        }
                        $('.to-back-wrap').html('<a href="/" class="back-btn">Назад к региону</a>');
                        $('.get-regions').html('<img src="' + resp.gerb_im + '" alt="">' + resp.title);
                        $('#categories').html(html);
                        $('.regions-modal').removeClass('active');
                    }
                });

            });
        });

        function mapInit(r_coords = null, objects_list = null, rayon_id = null, category_id = null, mapId = null, project = null) {
            // Создание карты.
            if (rayon_id == null) {
                rayon_id = 0;
            }
            if (category_id == null) {
                category_id = 0;
            }
            if (mapId == null) {
                mapId = 'map'
            }

            if (project != null) {
                self.__map.geoObjects
                    .add(new ymaps.Placemark(JSON.parse(project['project'].marker), {
                        balloonContent: project['project'].title
                    }, {
                        preset: 'islands#circleIcon',
                        iconColor: project['project'].color

                    }));
            } else {
                if (objects_list != null) {
                    if(Object.keys(objects_list).length < 200){
                        for(item in objects_list) {
                            myPieChart[item] = new ymaps.Placemark(JSON.parse(objects_list[item].marker), {
                                balloonContent: objects_list[item].title
                            }, {
                                preset: 'islands#circleIcon',
                                iconColor: objects_list[item].color

                            })
                            myPieChart[item].events.add('click', set_handler(item),false);

                            function set_handler(item){
                                return function (e) {
                                    mapprojectFunction(rayon_id, category_id, objects_list[item].p_id);
                                }};
                            self.__map.geoObjects.add(myPieChart[item]);
                        }
                    }
                    else {
                        myPieChart = [];
                        var ob_counter = 0;
                        for (item in objects_list) {
                            myPieChart[ob_counter] = new ymaps.Placemark(JSON.parse(objects_list[item].marker), {
                                balloonContent: objects_list[item].title
                            }, {
                                preset: 'islands#circleIcon',
                                iconColor: objects_list[item].color

                            })
                            myPieChart[ob_counter].events.add('click', set_handler(item), false);
                            ob_counter++;

                            function set_handler(item) {
                                return function (e) {
                                    mapprojectFunction(rayon_id, category_id, objects_list[item].p_id);
                                }
                            };
                        }
                        /*self.__map.geoObjects.add(myPieChart[item]);*/
                        clusterer = new ymaps.Clusterer({
                            // Макет метки кластера pieChart.
                            clusterIconLayout: 'default#pieChart',
                            // Радиус диаграммы в пикселях.
                            clusterIconPieChartRadius: 20,
                            // Радиус центральной части макета.
                            clusterIconPieChartCoreRadius: 10,
                            // Ширина линий-разделителей секторов и внешней обводки диаграммы.
                            clusterIconPieChartStrokeWidth: 3,
                            // Определяет наличие поля balloon.
                            hasBalloon: false,
                            maxZoom: 13,
                            groupByCoordinates: false,
                        });

                        /**
                         * В кластеризатор можно добавить javascript-массив меток (не геоколлекцию) или одну метку.
                         * @see https://api.yandex.ru/maps/doc/jsapi/2.1/ref/reference/Clusterer.xml#add
                         */
                        clusterer.add(myPieChart);
                        self.__map.geoObjects.add(clusterer);
                    }

                }
                else {
                    myPieChart = [];
                    {% for item in projects_to_map %}
                        myPieChart[{{forloop.counter}} -1] = new ymaps.Placemark({{item.marker}}, {
                            balloonContent: '{{item.title}}'
                        }, {
                            preset: 'islands#circleIcon',
                            iconColor: '{{item.category.color}}'

                        });
                        myPieChart[{{forloop.counter}} -1].events.add('click', function (e) {
                            mapprojectFunction({{item.rayon.id}}, {{item.category.id}}, {{item.id}});
                        });
                        /*self.__map.geoObjects
                            .add(myPieChart);*/
                    {% endfor %}
                    /*self.__map.geoObjects.add(myPieChart[item]);*/
                    clusterer = new ymaps.Clusterer({
                        // Макет метки кластера pieChart.
                        clusterIconLayout: 'default#pieChart',
                        // Радиус диаграммы в пикселях.
                        clusterIconPieChartRadius: 25,
                        // Радиус центральной части макета.
                        clusterIconPieChartCoreRadius: 10,
                        // Ширина линий-разделителей секторов и внешней обводки диаграммы.
                        clusterIconPieChartStrokeWidth: 3,
                        // Определяет наличие поля balloon.
                        hasBalloon: false,
                        maxZoom: 13,
                        groupByCoordinates: false,
                    });

                    /**
                     * В кластеризатор можно добавить javascript-массив меток (не геоколлекцию) или одну метку.
                     * @see https://api.yandex.ru/maps/doc/jsapi/2.1/ref/reference/Clusterer.xml#add
                     */
                    clusterer.add(myPieChart);
                    self.__map.geoObjects.add(clusterer);
                }
            }

            if (r_coords != null) {
                for (let key in JSON.parse(JSON.stringify(r_coords))) {
                    let bP = r_coords[key];
                    var polygon = new ymaps.Polygon(
                        bP,
                        {
                            hintContent: ''
                        }, {
                            fillColor: '#51FFB1',
                            interactivityModel: 'default#transparent',
                            strokeWidth: 2,
                            strokeColor: '#51ffb1',
                            strokeOpacity: 1,
                            opacity: 0.3
                        });
                }
            } else {
                for (let key in _coords) {
                    let bP = _coords[key];
                    var polygon = new ymaps.Polygon(
                        bP,
                        {
                            hintContent: ''
                        }, {
                            fillColor: '#51FFB1',
                            interactivityModel: 'default#transparent',
                            strokeWidth: 2,
                            strokeColor: '#51FFB1',
                            strokeOpacity: 1,
                            opacity: 0.3
                        });

                }

            }
            self.__map.geoObjects.add(polygon);
            self.__map.setBounds(__map.geoObjects.getBounds());
            offSpinner();
        }

        function getProgect(e) {
            event.preventDefault();

            var data_rayon_id = 0;
            if (e.getAttribute('data-rayon-id')) {
                data_rayon_id = e.getAttribute('data-rayon-id');
            }
            var data_category_id = 0;
            if (e.getAttribute('data-id')) {
                data_category_id = e.getAttribute('data-id');
            }
            $.ajax({
                url: "/projectview/",
                type: "GET",
                data: {r_id: data_rayon_id, c_id: data_category_id, p_id: e.getAttribute('data-p-id')},
                cache: false,
                dataType: "json",
                beforeSend: function(){
                    onSpinner();
                },
                success: function (resp) {
                    //------------------------------------------------------------------------------------------------
                    pr_html = '';
                    pr_html += resp.project_content;

                    var proj = resp.p_list;
                    var rayon_coords = JSON.parse(resp.p_list['project'].r_coords);
                    if (self.__map.geoObjects) {
                        self.__map.geoObjects.removeAll();
                    }
                    mapInit(r_coords = rayon_coords, project = proj, mapId = mapid);

                    $('.project-modal__content').html(pr_html);
                    $('.project-modal').addClass('active');

                }
            });
            $('.close-project-modal').unbind("click").click (function () {
                event.preventDefault();
                $.ajax({
                    url: "/projects-list/",
                    type: "GET",
                    data: {r_id: data_rayon_id, c_id: data_category_id},
                    cache: false,
                    dataType: "json",
                    beforeSend: function(){
                        onSpinner();
                    },
                    success: function (resp) {
                        var rayon_coords = JSON.parse(resp.r_coords);
                        var ob_list = resp.ob_list;
                        var r_id = resp.r_id;
                        var c_id = resp.c_id;
                        if (self.__map.geoObjects) {
                            self.__map.geoObjects.removeAll();
                        }
                        mapInit(r_coords = rayon_coords, objects_list = ob_list, rayon_id = r_id, category_id = c_id);
                    }
                });
                $('.project-modal').removeClass('active');
                $('.project-block').remove();
            });
        }

        function getCategory(e) {
            event.preventDefault();
            var data_rayon_id = 0;
            if (e.getAttribute('data-rayon-id')) {
                data_rayon_id = e.getAttribute('data-rayon-id')
            }
            var data_category_id = 0;
            if (e.getAttribute('data-id')) {
                data_category_id = e.getAttribute('data-id')
            }

            $.ajax({
                url: "/projects-list/",
                type: "GET",
                data: {r_id: data_rayon_id, c_id: e.getAttribute('data-id')},
                cache: false,
                dataType: "json",
                beforeSend: function(){
                    onSpinner();
                },
                success: function (resp) {

                    pr_html = '';


                    for (item in resp.ob_list) {
                        pr_html += `<a href="#" class="main-modal__regions__header" onclick="getProgect(this)" data-id="${resp.c_id}" data-rayon-id="${resp.r_id}" data-p-id="${resp.ob_list[item].p_id}"><p class="main-modal__title">${resp.ob_list[item].title}</p><p class="main-modal__subtitle">${resp.ob_list[item].adress}</p></a>`;
                    }
                    $('.category-modal__content').html(pr_html);
                    $('.category-modal').addClass('active');

                    var rayon_coords = JSON.parse(resp.r_coords);
                    var ob_list = resp.ob_list;
                    var r_id = resp.r_id;
                    var c_id = resp.c_id;
                    if (self.__map.geoObjects) {
                        self.__map.geoObjects.removeAll();
                    }
                    mapInit(r_coords = rayon_coords, objects_list = ob_list, rayon_id = r_id, category_id = c_id);
                    offSpinner();
                    //------------------------------------------------------------------------------------------------
                }
            });
            $('.close-category-modal').unbind("click").click (function () {
                event.preventDefault();
                //history.pushState(null, null, '/rayon/?id='+$(this).attr("data-id"));
                $.ajax({
                    url: "/rayon/",
                    type: "GET",
                    data: {id: data_rayon_id},
                    cache: false,
                    dataType: "json",
                    beforeSend: function(){
                        onSpinner();
                    },
                    success: function (resp) {
                        var rayon_coords = JSON.parse(resp.coords);
                        var ob_list = resp.ob_list;
                        var r_id = resp.id;
                        if (self.__map.geoObjects) {
                            self.__map.geoObjects.removeAll();
                        }
                        mapInit(r_coords = rayon_coords, objects_list = ob_list, rayon_id = r_id);
                    }
                });
                $('.category-modal').removeClass('active');
            });
        }

        function mapregionfunction(r_id = 0) {
            event.preventDefault();
            //history.pushState(null, null, '/rayon/?id='+$(this).attr("data-id"));
            $.ajax({
                url: "/rayon/",
                type: "GET",
                data: {id: r_id},
                cache: false,
                dataType: "json",
                beforeSend: function(){
                    onSpinner();
                },
                success: function (resp) {
                    var rayon_coords = JSON.parse(resp.coords);
                    var ob_list = resp.ob_list;
                    var r_id = resp.id;
                    if (self.__map.geoObjects) {
                        self.__map.geoObjects.removeAll();
                    }
                    mapInit(r_coords = rayon_coords, objects_list = ob_list, rayon_id = r_id);

                    html = ''
                    if (resp.full_objects_count || resp.full_investments) {
                        html += '<div class="region-info">';
                        if (resp.full_objects_count) {
                            html += '<div><p class="region-info__count">' + resp.full_objects_count + '</p><p class="region-info__subtitle">всего объектов</p></div>';
                        }
                        if (resp.full_investments) {
                            html += '<div><p class="region-info__count">' + resp.full_investments + '</p><p class="region-info__subtitle">объем финансирования</p></div>';
                        }
                        html += '</div>';
                    }
                    html += '<div id="accordion">';
                    for (item in resp.r_c_list) {
                        html +=
                            '<div class="card"><div class="card-header" id="heading-' + item + '"><a class="" data-toggle="collapse" data-target="#collapse-' + item + '" aria-expanded="true" aria-controls="collapseOne"><p class="card-title">'

                            + resp.r_c_list[item].category_name +

                            '</p><p class="card-subtitle">'

                            + resp.r_c_list[item].objects_count + ', ' + resp.r_c_list[item].investments +

                            '</p></a></div>' +
                            '<div id="collapse-' + item + '" class="collapse card-content" aria-labelledby="heading-' + item + '" data-parent="#accordion">';

                        if (resp.r_c_list[item].rayon_sub_category) {
                            var sub_category = resp.r_c_list[item].rayon_sub_category;

                            for (i in sub_category) {
                                html +=
                                    '<div><p class="card-content__title">'
                                    + sub_category[i].category_name +
                                    '</p><p class="card-content__subtitle">'
                                    + sub_category[i].objects_count + ', ' + sub_category[i].investments +
                                    '</p></div>';
                            }
                        }

                        html += '</div></div>';
                    }
                    html += '</div>';
                    /*
                    if (resp.infografika_im || resp.mobile_infografika_im) {
                        html += '<div uk-lightbox class="d-none d-md-block"><a href="' + resp.infografika_im + '" class="region-pasport-btn mt-1" style="background-color: #F2F2F2; color: #4F4F4F;">Паспорт MO</a></div>';

                        if (resp.mobile_infografika_im) {
                            html += '<div uk-lightbox class="d-md-none d-block"><a href="' + resp.mobile_infografika_im + '" class="region-pasport-btn mt-1" style="background-color: #F2F2F2; color: #4F4F4F;">Паспорт MO</a></div>';
                        }

                    }
                    */
                    for (item in resp.c_list) {

                        html += '<div><a class="category_btn my-1" onclick="getCategory(this)" data-id="'
                            + item + '" data-rayon-id="' + resp.id + '" style="background-color: ' + resp.c_color[item] + '" value="' + item + '"> <img src="' + resp.c_img[item] + '" alt=""><div>' + resp.c_list[item] + ' <span class="font-weight-normal">(' + resp.c_count[item] + ')</span></div></a></div>';

                    }
                    $('.to-back-wrap').html('<a href="/" class="back-btn">Назад к региону</a>');
                    $('.get-regions').html('<img src="' + resp.gerb_im + '" alt="">' + resp.title);
                    $('#categories').html(html);
                }
            });

        }

        function mapclickFunction(r_id = 0, c_id = 0) {
            event.preventDefault();

            $.ajax({
                url: "/projects-list/",
                type: "GET",
                data: {r_id: r_id, c_id: c_id},
                cache: false,
                dataType: "json",
                beforeSend: function(){
                    onSpinner();
                },
                success: function (resp) {

                    pr_html = '';


                    for (item in resp.ob_list) {
                        pr_html += '<a href="#" class="main-modal__regions__header" onclick="getProgect(this)" data-id="' + resp.c_id + '" data-rayon-id="' + resp.r_id + '" data-p-id="' + resp.ob_list[item].p_id + '"><p class="main-modal__title">' + resp.ob_list[item].title + '</p>' + '<p class="main-modal__subtitle">' + resp.ob_list[item].adress + '</p></a>';
                    }
                    $('.category-modal__content').html(pr_html);
                    $('.category-modal').addClass('active');
                    $('.close-category-modal').unbind("click").click (function () {
                        event.preventDefault();
                        //history.pushState(null, null, '/rayon/?id='+$(this).attr("data-id"));
                        mapregionfunction(r_id);
                        $('.category-modal').removeClass('active');
                    });

                    var rayon_coords = JSON.parse(resp.r_coords);
                    var ob_list = resp.ob_list;
                    var r_id = resp.r_id;
                    var c_id = resp.c_id;
                    if (self.__map.geoObjects) {
                        self.__map.geoObjects.removeAll();
                    }
                    mapInit(r_coords = rayon_coords, objects_list = ob_list, rayon_id = r_id, category_id = c_id);
                    //------------------------------------------------------------------------------------------------
                }
            });
        }

        function mapprojectFunction(r_id, c_id, p_id) {
            event.preventDefault();
            $.ajax({
                url: "/projectview/",
                type: "GET",
                data: {r_id: r_id, c_id: c_id, p_id: p_id},
                cache: false,
                dataType: "json",
                beforeSend: function(){
                    onSpinner();
                },
                success: function (resp) {
                    //------------------------------------------------------------------------------------------------

                    pr_html = '';
                    pr_html += resp.project_content;
                    var proj = resp.p_list;
                    var rayon_coords = JSON.parse(resp.p_list['project'].r_coords);
                    if (self.__map.geoObjects) {
                        self.__map.geoObjects.removeAll();
                    }
                    mapInit(r_coords = rayon_coords, project = proj, mapId = mapid);
                    $('.project-modal__content').html(pr_html);
                    $('.project-modal').addClass('active');
                    $('.close-project-modal').unbind("click").click (function () {
                        event.preventDefault();
                        mapclickFunction(r_id, c_id);
                        $('.project-modal').removeClass('active');
                    });
                }
            });
        }

        function mapprojectFunction() {
            event.preventDefault();

            $.ajax({
                url: "/form/",
                type: "GET",
                data: {},
                cache: false,
                dataType: "text",
                success: function (resp) {
                    //------------------------------------------------------------------------------------------------
                    pr_html = '';
                    pr_html += resp;

                    $('.route-filter__content').html(pr_html);
                    $('#get-route-filter').addClass('active');

                },
                error: function (data) {
                    console.log('Error', data);
                },
            });
        }

        function submitFilter(i) {
            event.preventDefault();
            console.log(i);

            $.ajax({
                url: "/form/",
                type: "POST",
                data: $(i).serialize(),
                cache: false,
                dataType: "text",
                success: function (resp) {

                        pr_html = '';
                        pr_html += resp;

                        $('.route-filter__content').html(pr_html);


                },
                error: function (data) {
                    console.log('Error', data);
                },
            });
        }
        function getRout(i) {
            event.preventDefault();
            console.log(i);

            $.ajax({
                url: "/form/",
                type: "POST",
                data: $(i).serialize(),
                cache: false,
                dataType: "json",
                success: function (resp) {
                let objects = [];
                for(var it in resp.map_objects){
                   console.log(typeof(resp.map_objects[it].marker1));
                    objects.push([resp.map_objects[it].marker1, resp.map_objects[it].marker2]);
                }
                console.log(objects);
                    $('.route-filter__content').html(resp.project_content);
                    var multiRoute = new ymaps.multiRouter.MultiRoute({
                        referencePoints: objects,
                        params: {
                            // Установим вторую точку маршрута ('метро Смоленская')
                            // в качестве транзитной.
                            viaIndexes: [1]
                        }
                    }, {
                        boundsAutoApply: true
                    });
                    // Добавление маршрута на карту.
                    self.__map.geoObjects.add(multiRoute);


                },
                error: function (data) {
                    console.log('Error', data);
                },
            });
        }

    </script>
{%endblock%}

{%block content%}
    <div class="" style="min-height: 100%;">
        <div class="main-content">
            <div class="sidebar">
                <div class="projects_list">
                    <div class="to-back-wrap"></div>
                    <div class="mt-1 mb-2"><a class="get-route-filter button blue-btn" onclick="mapprojectFunction()"><img class="d-none" src="{% static 'img/gerb.png' %}" alt="">Куда едем</a></div>
                    <div class="mt-1 mb-2"><a class="get-regions button red-btn" >Выбрать маршрут</a></div>
                    <div class="mt-1 mb-2"><a class="button yellow-btn" onclick="getCategory(this)" data-id="0" data-rayon-id="0" >Посмотреть объекты</a></div>
                </div>
                {% include 'partials/footer.html' %}
            </div>
            <div class="map-wrap position-relative">
                <div id="map" style="width: 100%; height: 100%; min-height: calc(100vh - 112px);"></div>
            </div>
        </div>
    </div>


    <!-- Modals -->
    <div class="main-modal regions-modal">
        <div class="main-modal__content">
            <a href="" class="close-regions back-btn">Назад</a>
            {% for i in regions.all %}
                <a href="" class="region_btn my-1" style="background-color: #F2F2F2; color: #4F4F4F " data-id="{{ i.id }}">
                    {% if i.gerb_im %}<img src="{{ i.gerb_im.url }}" alt="">{% endif %}
                    {{ i.title }}
                </a>
            {% endfor %}
        </div>
    </div>

    <div class="main-modal category-modal">
        <div class="main-modal__content">
            <a href="" class="close-category-modal back-btn">Назад</a>
            <div class="category-modal__content"></div>
        </div>
    </div>

    <div class="main-modal project-modal">
        <div class="main-modal__content">
            <a href="" class="close-project-modal back-btn">Назад</a>
            <div class="project-modal__content"></div>
            <div class="mobile-map">
                <div id="mobile_map" style="width: 100%; height: 400px;"></div>
            </div>
        </div>
    </div>

    <div class="main-modal d-none" id="myModal">
        <div class="main-modal__content">
            {% include 'partials/modal_content.html' %}
        </div>
    </div>

    <div class="main-modal" id="get-route-filter">
        <div class="main-modal__content">
            <a href="" class="back-btn">Назад</a>
            <div class="route-filter__content"></div>
        </div>
    </div>



    <script>
        function getInfo(id) {
            event.preventDefault();

        }
        $("a[data-toggle='modal']").bind("click",function () {
            var id = $(this).attr('data-id');
            $.ajax({
                url: "test",
                cache: false,
                data: { id: id },
                type: "GET",
                success: function(html) { $('.modal__content').html(html);}
            });
        });


    </script>
{%endblock%}